<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>누구에게 문서를 전달해야할까?</title>
  <style>
    body {
      background: #f6f7fb;
      font-family: '맑은 고딕', sans-serif;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 98vw;
      width: 98vw;
      background: #fff;
      margin: 20px auto;
      border-radius: 18px;
      box-shadow: 0 6px 24px #dde2ed88;
      padding: 0 0 32px 0;
    }
    .mainimg { width: 100%; border-radius: 18px 18px 0 0; }
    .tabs {
      display: flex; margin: 18px 0 0 0;
    }
    .tab {
      flex: 1; text-align: center; cursor: pointer; padding: 13px 0;
      font-weight: bold; border-bottom: 2.5px solid #e0e0e0; background: #f6f8fa;
    }
    .tab.active {
      color: #1f5fd1; border-bottom: 3px solid #1f5fd1; background: #f8fbff;
    }
    .box {
      margin: 24px 24px 0 24px;
      padding: 22px;
      background: #f8fafc;
      border-radius: 14px;
      min-height: 170px;
    }
    .title {
      margin: 32px 0 0 0;
      text-align: center;
      font-size: 1.5em;
      font-weight: bold;
      color: #0a297a;
    }
    .subtitle {
      text-align: center;
      color: #325e97;
      font-weight: 500;
      margin-bottom: 18px;
    }
    .timer {
      margin: 14px 0;
      text-align: center;
    }
    .timer label {
      font-weight: bold;
      margin: 0 9px 0 0;
    }
    .timer button {
      margin: 0 4px;
      padding: 7px 20px;
      font-size: 1em;
      border-radius: 8px;
      border: 1.5px solid #d2d5dd;
      background: #f6f7fc;
      cursor: pointer;
      font-weight: bold;
    }
    .timer button.selected {
      background: #295ce2;
      color: #fff;
      border-color: #2149ad;
    }
    .timer span {
      display: inline-block;
      margin-left: 14px;
      color: #21732a;
      font-weight: bold;
      font-size: 1.2em;
    }
    .radio-wrap { margin-top: 18px; }
    .radio-wrap label { margin-right: 20px; }
    .success { color: #2c781a; font-weight: bold; }
    .fail { color: #bb2124; font-weight: bold; }
    .hint { color: #235a99; font-size: .93em; }
    .remain { font-weight: bold; color: #21732a; margin-top: 8px; }
    .situationbox {
      background: #f1f5fa;
      border-radius: 15px;
      padding: 22px 20px 14px 20px;
      margin: 26px 28px 0 28px;
      box-shadow: 0 1px 8px #bdd1ee36;
      border-left: 6px solid #356dc6;
      font-size: 1.04em;
      color: #18365a;
      line-height: 1.7;
    }
    .featurebox {
      background: #eaf4fd;
      border-radius: 15px;
      padding: 18px 18px 14px 18px;
      margin: 12px 28px 0 28px;
      box-shadow: 0 1px 6px #bdd1ee36;
      border-left: 6px solid #4bb0f9;
      font-size: 1.04em;
      color: #174a6c;
      line-height: 1.7;
    }
    .featurebox ul { margin: 7px 0 0 0; padding-left: 17px; }
    .featurebox li { margin-bottom: 2px; }
    .drag-item {
      background: #dbe8fa;
      padding: 10px;
      margin: 8px 0;
      border-radius: 8px;
      cursor: grab;
      font-size: 0.96em;
    }
    .drop-slot {
      background: #ffffff;
      border: 2px dashed #a3bcd9;
      margin: 12px 0;
      padding: 14px;
      min-height: 45px;
      border-radius: 8px;
      font-size: 0.96em;
    }
    .btn {
      margin: 10px 8px 0 0;
      padding: 8px 28px;
      border-radius: 10px;
      border: none;
      font-size: 1em;
      background: #3367e6;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
    }
    .btn.reset { background: #adb8c4; }
  </style>
</head>
<body>
  <div class="container">
    <img src="image.png" class="mainimg" alt="문제 이미지">
    <div class="title">타이틀: 누구에게 문서를 전달해야할까?</div>
    <div class="subtitle">대상 및 교과: 중학교 (특수)</div>
    <div class="timer">
      <label>문제 풀이 시간:</label>
      <button id="timer-btn-30">30초</button>
      <button id="timer-btn-60">1분</button>
      <button id="timer-btn-90">1분 30초</button>
      <button id="timer-btn-120">2분</button>
      <span id="timer_display">0:00</span>
    </div>
    <div class="situationbox">
      <b>문제 상황</b><br>
      철수는 담임 선생님으로부터 다음과 같은 특별한 부탁을 받았습니다.<br>
      “지금 저기 복도에 있는 4명의 선생님 중에 홍길동 선생님에게 이 문서를 전달해줘.”<br>
      철수는 선생님들의 외형을 잘 관찰하여 특징에 맞는 올바른 선생님에게 문서를 전달해야 합니다.
    </div>
    <div class="featurebox">
      <b>홍길동 선생님 특징</b>
      <ul>
        <li>바지를 입고 있다.</li>
        <li>책을 들고 있지 않다.</li>
        <li>안경을 쓰고 있다.</li>
      </ul>
    </div>

    <div class="tabs">
      <div class="tab active" id="tab-btn-0">문제분해</div>
      <div class="tab" id="tab-btn-1">추상화</div>
      <div class="tab" id="tab-btn-2">패턴(규칙) 찾기</div>
      <div class="tab" id="tab-btn-3">알고리즘</div>
    </div>
    <!-- 문제분해 탭 -->
    <div id="tabbox0" class="box">
      <div style="font-weight:bold;">문제분해: 문제 해결 순서를 올바르게 배열해보세요.</div>
      <div class="hint">아래 단계 카드를 드래그하여 오른쪽 빈 칸에 순서대로 배치해보세요.</div>
      <div style="display: flex; gap: 20px; margin-top: 20px;">
        <!-- 드래그 카드 -->
        <div id="drag-items" style="flex: 1; background: #f1f4f9; padding: 10px; border-radius: 10px;">
          <div class="drag-item" draggable="true" data-id="2">홍길동 선생님의 3가지 특징(하의 종류, 안경, 책)을 확인한다.</div>
          <div class="drag-item" draggable="true" data-id="1">4명의 선생님들의 특징을 확인한다.</div>
          <div class="drag-item" draggable="true" data-id="3">홍길동 선생님의 3가지 특징과 비교하여 모두 해당하는 선생님을 찾는다.</div>
        </div>
        <!-- 드롭 슬롯 -->
        <div id="drop-zone" style="flex: 1; background: #eef2f8; padding: 10px; border-radius: 10px; min-height: 180px;">
          <div class="drop-slot" data-slot="1"><b>①</b> 순서 1</div>
          <div class="drop-slot" data-slot="2"><b>②</b> 순서 2</div>
          <div class="drop-slot" data-slot="3"><b>③</b> 순서 3</div>
        </div>
      </div>
      <button id="check-order" class="btn" style="margin-top: 20px;">정답 확인</button>
      <button id="reset-order" class="btn reset" style="margin-top: 20px;">다시 하기</button>
      <span id="order-feedback" style="margin-left:16px; font-weight:bold;"></span>
    </div>

    <!-- 추상화 탭 -->
    <div id="tabbox1" class="box" style="display:none;">
      <div style="font-weight:bold;">추상화: 홍길동 선생님의 특징을 추려내보세요.</div>
      <div class="hint">다음 보기 중, 홍길동 선생님을 찾기 위해 반드시 필요한 3가지 조건만 선택하세요. (복수 선택 가능)</div>
      <form id="abstraction-form" style="margin-top:10px;">
        <label><input type="checkbox" name="q" value="book" /> 📕 책을 들고 있지 않다</label><br>
        <label><input type="checkbox" name="q" value="tie" /> 👔 넥타이를 매고 있다</label><br>
        <label><input type="checkbox" name="q" value="pants" /> 👖 바지를 입고 있다</label><br>
        <label><input type="checkbox" name="q" value="arms" /> 🙅‍♂️ 팔짱을 끼고 있다</label><br>
        <label><input type="checkbox" name="q" value="shirt" /> 👕 셔츠를 입고 있다</label><br>
        <label><input type="checkbox" name="q" value="glasses" /> 👓 안경을 쓰고 있다</label><br>
      </form>
      <button onclick="checkAbstraction()" class="btn" style="margin-top:10px;">정답 확인</button>
      <button onclick="resetAbstraction()" class="btn" style="margin-top:10px; margin-left:10px;">다시 하기</button>
      <div id="abstraction-feedback" style="margin-top:10px; font-weight:bold;"></div>
    </div>

    <!-- 문제분해/추상화 드래그/체크 JS -->
    <script>
      // 문제분해 드래그앤드롭
      let draggedItem = null;
      const dragItems = document.querySelectorAll(".drag-item");
      const dropSlots = document.querySelectorAll(".drop-slot");
      const dragContainer = document.getElementById("drag-items");

      dragItems.forEach(item => {
        item.addEventListener("dragstart", e => {
          draggedItem = item;
        });
      });

      dropSlots.forEach(slot => {
        slot.addEventListener("dragover", e => e.preventDefault());
        slot.addEventListener("drop", e => {
          e.preventDefault();
          if (draggedItem) {
            slot.innerHTML = "";
            slot.appendChild(draggedItem);
            draggedItem = null;
          }
        });
      });

      document.getElementById("check-order").addEventListener("click", () => {
        const expectedOrder = ["2", "1", "3"];
        let userOrder = [];
        dropSlots.forEach(slot => {
          const child = slot.querySelector(".drag-item");
          if (child) userOrder.push(child.dataset.id);
        });
        const correct = expectedOrder.every((val, idx) => userOrder[idx] === val);
        document.getElementById("order-feedback").innerHTML = correct
          ? '<span class="success">정답입니다!</span>'
          : '<span class="fail">순서가 틀렸습니다.</span>';
      });

      document.getElementById("reset-order").addEventListener("click", () => {
        dragItems.forEach(item => {
          dragContainer.appendChild(item);
        });
        dropSlots.forEach((slot, idx) => {
          slot.innerHTML = `<b>${"①②③"[idx]}</b> 순서 ${idx + 1}`;
        });
        document.getElementById("order-feedback").innerHTML = "";
      });

      // 추상화 확인
      function checkAbstraction() {
        const correct = ["pants", "book", "glasses"];
        const checked = Array.from(document.querySelectorAll('input[name="q"]:checked')).map(cb => cb.value);
        const isCorrect = correct.length === checked.length && correct.every(val => checked.includes(val));
        const feedback = document.getElementById("abstraction-feedback");

        if (isCorrect) {
          feedback.innerHTML = '<span class="success">정답입니다! 필요한 정보만 정확히 추렸어요 🎉</span>';
        } else {
          const missed = correct.filter(c => !checked.includes(c));
          const extra = checked.filter(c => !correct.includes(c));
          feedback.innerHTML = '<span class="fail">정답이 아닙니다.<br>' +
            (missed.length ? `❗ 빠뜨린 조건: ${missed.join(", ")}<br>` : "") +
            (extra.length ? `⚠️ 불필요한 조건 선택됨: ${extra.join(", ")}` : "") +
            '</span>';
        }
      }

      function resetAbstraction() {
        document.querySelectorAll('input[name="q"]').forEach(cb => cb.checked = false);
        document.getElementById("abstraction-feedback").innerHTML = "";
      }
    </script>
    <!-- 패턴(규칙) 찾기 탭 -->
    <div id="tabbox2" class="box" style="display:none">
      <b>패턴(규칙) 찾기 단계</b>
      <div style="margin:16px 0 0 0;">
        조건을 순서대로 적용하며 남은 후보를 확인해 보세요.<br>
        <span class="hint">아래 '다음 조건 적용'을 누르면 필터링이 진행됩니다.</span>
      </div>
      <div id="pattern-progress" style="margin:10px 0; font-weight:bold;">
        현재 적용된 조건: <span id="applied-count">0</span> / <span id="total-count">3</span>
      </div>
      <div id="pattern-steps" class="pattern-step-list"></div>
      <div id="pattern-candidates" style="margin:14px 0;font-weight:bold;">
        남은 후보: ①, ②, ③, ④
      </div>
      <div id="pattern-explanation" style="margin:10px 0; color:#2c3e50; font-size:14px; font-style:italic;">
        (조건이 적용되면 해설이 여기에 표시됩니다.)
      </div>
      <button id="pattern-next" class="btn">다음 조건 적용</button>
      <button id="pattern-reset" class="btn reset">초기화</button>
    </div>

    <!-- 알고리즘 탭 -->
    <div id="tabbox3" class="box" style="display:none">
      <b>알고리즘 단계</b>
      <div style="margin:16px 0 10px 0;">정답을 찾아 문서를 전달할 선생님을 선택하세요.</div>
      <div class="radio-wrap">
        <label><input type="radio" name="answer" value="1"> 1번</label>
        <label><input type="radio" name="answer" value="2"> 2번</label>
        <label><input type="radio" name="answer" value="3"> 3번</label>
        <label><input type="radio" name="answer" value="4"> 4번</label>
      </div>
      <button id="algorithm-btn" class="btn">정답 확인</button>
      <div id="algorithm-process" style="margin:16px 0 0 0; font-size:0.98em; color:#224;"></div>
      <span id="algorithm-feedback" style="margin-left:8px; font-weight:bold;"></span>
    </div>

    <script>
      // 탭 전환 함수
      function showTab(idx) {
        for (let i = 0; i < 4; i++) {
          document.querySelectorAll('.tab')[i].classList.remove('active');
          document.getElementById('tabbox' + i).style.display = (i === idx) ? "block" : "none";
        }
        document.querySelectorAll('.tab')[idx].classList.add('active');
        if (idx === 2) showPatternStatus();
      }

      // 타이머
      let timer = null, timerValue = 0, timerRemain = 0;
      function setTimer(sec, btn) {
        timerValue = sec;
        timerRemain = sec;
        updateTimer();
        document.querySelectorAll('.timer button').forEach(b => b.classList.remove('selected'));
        if (btn) btn.classList.add('selected');
        if (timer) clearInterval(timer);
        timer = setInterval(function () {
          timerRemain--;
          updateTimer();
          if (timerRemain <= 0) {
            clearInterval(timer);
            alert("⏰ 시간이 종료되었습니다!\n다시 도전하려면 시간을 선택하세요.");
            document.querySelectorAll('.timer button').forEach(b => b.classList.remove('selected'));
          }
        }, 1000);
      }

      function updateTimer() {
        document.getElementById('timer_display').innerText =
          `${Math.floor(timerRemain / 60)}:${String(timerRemain % 60).padStart(2, '0')}`;
      }

      // 알고리즘 확인
      function checkAlgorithmAnswer() {
        const teachers = [
          { no: 1, 바지: false, 책: false, 안경: true },
          { no: 2, 바지: true, 책: true, 안경: true },
          { no: 3, 바지: true, 책: false, 안경: true },
          { no: 4, 바지: true, 책: false, 안경: false }
        ];
        let processMsg = "<b>알고리즘 처리 과정:</b><br>";
        let current = [...teachers];
        processMsg += "초기 후보: " + current.map(t => `<b>${t.no}번</b>`).join(', ') + "<br>";
        current = current.filter(t => t.바지);
        processMsg += "① 바지를 입고 있는 후보: " + (current.length ? current.map(t => `<b>${t.no}번</b>`).join(', ') : '없음') + "<br>";
        current = current.filter(t => !t.책);
        processMsg += "② 책을 들고 있지 않은 후보: " + (current.length ? current.map(t => `<b>${t.no}번</b>`).join(', ') : '없음') + "<br>";
        current = current.filter(t => t.안경);
        processMsg += "③ 안경을 쓰고 있는 후보: " + (current.length ? current.map(t => `<b>${t.no}번</b>`).join(', ') : '없음') + "<br>";
        let rightNo = current.length ? current[0].no : null;
        processMsg += "<b>최종 남은 후보: " + (current.length ? `${current[0].no}번` : "없음") + "</b>";
        document.getElementById('algorithm-process').innerHTML = processMsg;

        const radios = document.getElementsByName('answer');
        let userPick = null;
        for (let r of radios) if (r.checked) userPick = parseInt(r.value);
        let feedback = '';
        if (!userPick) {
          feedback = '<span class="fail">번호를 선택하세요.</span>';
        } else if (userPick === rightNo) {
          feedback = '<span class="success">정답입니다!</span>';
        } else {
          feedback = '<span class="fail">정답이 아닙니다.</span>';
        }
        document.getElementById('algorithm-feedback').innerHTML = feedback;
      }

      // 패턴 탭 관련
      const teachers = [
        { no: 1, 바지: false, 책: false, 안경: true },
        { no: 2, 바지: true, 책: true, 안경: true },
        { no: 3, 바지: true, 책: false, 안경: true },
        { no: 4, 바지: true, 책: false, 안경: false }
      ];
      const patternSteps = [
        { label: "바지를 입고 있다", key: "바지", value: true },
        { label: "책을 들고 있지 않다", key: "책", value: false },
        { label: "안경을 쓰고 있다", key: "안경", value: true }
      ];
      let patternIdx = 0;
      let candidates = [1, 2, 3, 4];
      function showPatternStatus() {
        document.getElementById('applied-count').innerText = patternIdx;
        document.getElementById('total-count').innerText = patternSteps.length;
        document.getElementById('pattern-candidates').innerText = "남은 후보: " + (candidates.length ? candidates.map(n => `①②③④`[n - 1]).join(", ") : "없음");
        let stepInfo = '';
        for (let i = 0; i < patternSteps.length; i++) {
          stepInfo += `<div>${i + 1}. ${patternSteps[i].label} ${i < patternIdx ? "✔️" : ""}</div>`;
        }
        document.getElementById('pattern-steps').innerHTML = stepInfo;
        document.getElementById('pattern-explanation').innerText = patternIdx > 0
          ? `${patternSteps[patternIdx - 1].label} 조건을 만족하지 않는 후보 제외`
          : '(조건이 적용되면 해설이 여기에 표시됩니다.)';
      }

      // DOM 로딩 후 이벤트 바인딩
      document.addEventListener('DOMContentLoaded', function () {
        // 탭 이벤트
        for (let i = 0; i < 4; i++) {
          document.getElementById('tab-btn-' + i).addEventListener('click', function () { showTab(i); });
        }
        // 타이머
        document.getElementById('timer-btn-30').onclick = function () { setTimer(30, this); };
        document.getElementById('timer-btn-60').onclick = function () { setTimer(60, this); };
        document.getElementById('timer-btn-90').onclick = function () { setTimer(90, this); };
        document.getElementById('timer-btn-120').onclick = function () { setTimer(120, this); };
        updateTimer();

        // 알고리즘 확인
        document.getElementById('algorithm-btn').onclick = checkAlgorithmAnswer;

        // 패턴탭
        document.getElementById('pattern-next').onclick = function () {
          if (patternIdx >= patternSteps.length) return;
          const step = patternSteps[patternIdx];
          candidates = candidates.filter(n =>
            teachers.find(t => t.no === n)[step.key] === step.value
          );
          patternIdx++;
          showPatternStatus();
        };
        document.getElementById('pattern-reset').onclick = function () {
          patternIdx = 0;
          candidates = [1, 2, 3, 4];
          showPatternStatus();
        };
        showPatternStatus();
      });
    </script>
  </div> <!-- .container -->
</body>
</html>
