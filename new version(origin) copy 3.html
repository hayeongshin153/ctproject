<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>컴퓨팅 사고 기반 문제 해결 활동</title>
  <style>
    body { font-family: "맑은 고딕", sans-serif; margin: 20px; }
    h1 { color: #1a237e; }
    h2 { color: #d32f2f; }
    .tabs { display: flex; margin-top: 20px; }
    .tab-button {
      padding: 10px 20px; margin-right: 5px;
      border: 1px solid #ccc; background: #f5f5f5; cursor: pointer;
    }
    .tab-button.active {
      background: white; border-bottom: none; font-weight: bold;
    }
    .tab-content { display: none; border: 1px solid #ccc; padding: 20px; }
    .tab-content.active { display: block; }

    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    th, td { border: 1px solid #999; padding: 8px; text-align: center; }
    th { background: #eee; }
    .highlight { background: #e0efff; }
    .border-red { border: 3px solid red !important; }
    .border-blue { border: 3px solid blue !important; }

    input[type="checkbox"] { margin-right: 6px; }
    .correct { color: green; font-weight: bold; }
    .incorrect { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <h1>오늘은 어디로 가야할까?</h1>
  <h2>
    컴퓨팅 사고 기반 문제 해결 활동
    <button onclick="generateRandomDayPeriod()" style="margin-left:20px;">📅 요일·교시 랜덤 생성</button>
  </h2>
  <div id="randomResult" style="margin: 10px 0; font-weight: bold;"></div>

  <h3>📌 길동이의 전체 시간표</h3>
  <div id="timetable-container"></div>

  <div style="margin-top: 10px; font-size: 0.95em;">
    <p style="color:#444;">
      🔷 <strong>색칠된 시간</strong>은 특수학급 수업 시간입니다.
    </p>
    <p style="color:#444;">
      📍 <strong>다음 과목은 지정 장소로 이동하세요</strong> →  
      체육: <span style="color:#2e86c1;">운동장</span>,  
      음악: <span style="color:#af7ac5;">음악실</span>,  
      미술: <span style="color:#f39c12;">미술실</span>,  
      과학: <span style="color:#27ae60;">과학실</span>
    </p>
  </div>

  <!-- 탭 버튼 -->
  <div class="tabs">
    <div class="tab-button active" onclick="showTab(0)">1. 문제 분해</div>
    <div class="tab-button" onclick="showTab(1)">2. 추상화</div>
    <div class="tab-button" onclick="showTab(2)">3. 패턴 인식</div>
    <div class="tab-button" onclick="showTab(3)">4. 알고리즘</div>
  </div>

  <!-- 1. 문제 분해 -->
  <div class="tab-content active">
    <h3>📌 문제 분해:복잡한 문제를 작은 단위로 나누는 단계입니다.</h3>
    <p>이 문제를 해결하는 데 필요한 내용을 모두 선택해주세요.</p>
    <label><input type="checkbox" class="decomp-check" value="요일">요일</label><br>
    <label><input type="checkbox" class="decomp-check" value="선생님 이름">선생님 이름</label><br>
    <label><input type="checkbox" class="decomp-check" value="과목">과목</label><br>
    <label><input type="checkbox" class="decomp-check" value="교시">교시</label><br>
    <label><input type="checkbox" class="decomp-check" value="과목별 수업 장소">과목별 수업 장소</label><br>
    <label><input type="checkbox" class="decomp-check" value="특수학급 수업">특수학급 수업</label><br>
    <button onclick="checkDecomposition()">정답 확인</button>
    <div id="decompResult" style="margin-top:10px;"></div>
  </div>
  <!-- 2. 추상화 -->
  <div class="tab-content">
    <h3>📌 추상화:꼭 필요한 정보만 남기고, 불필요한 건 버리는 단계입니다.</h3>
    <label>요일 선택:
      <select id="daySelect" onchange="renderAbstraction()">
        <option>월</option><option>화</option><option>수</option>
        <option>목</option><option>금</option>
      </select>
    </label>
    <div id="abstractionTable"></div>
    <button onclick="checkAbstraction()">정답 확인</button>
    <div id="abstractionResult" style="margin-top:10px;"></div>
  </div>

  <!-- 3. 패턴 인식 -->
  <div class="tab-content">
    <h3>📌 패턴 인식:비슷한 문제나 규칙을 찾아내는 단계입니다.</h3>
    <p>시간표에서 나타나는 2가지 패턴을 아래 보기 중에서 찾으세요.</p>
    <label><input type="checkbox" class="pattern-check" value="special">모든 색칠된 과목은 특수학급 수업이다.</label><br>
    <label><input type="checkbox" class="pattern-check" value="wrong1">모든 색칠된 과목은 일반교실 수업이다.</label><br>
    <label><input type="checkbox" class="pattern-check" value="move">체육·음악·미술·과학은 지정된 다른 장소로 이동해야 한다.</label><br>
    <label><input type="checkbox" class="pattern-check" value="wrong2">국어·수학·영어·도덕은 이동해야 한다.</label><br>
    <button onclick="checkPatternVisual()">정답 보기</button>
    <div id="patternResult" style="margin-top:10px;"></div>
  </div>

  <!-- 4. 알고리즘 -->
  <div class="tab-content">
    <h3>📌 알고리즘:문제를 해결하기 위한 순서나 절차를 만드는 단계입니다.</h3>
    <p>요일·교시·과목명·특수학급 여부를 선택하고, 해당 교시에 가야할 장소를 예측해 보세요.</p>
    <table>
      <tr>
        <td>무슨 요일인가요?</td>
        <td>
          <select id="algo-day">
            <option>월</option><option>화</option><option>수</option>
            <option>목</option><option>금</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>몇 교시인가요?</td>
        <td>
          <select id="algo-period">
            <option>1교시</option><option>2교시</option><option>3교시</option>
            <option>4교시</option><option>5교시</option><option>6교시</option>
            <option>7교시</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>과목명은 무엇인가요?</td>
        <td><input type="text" id="algo-subject" placeholder="예: 국어"></td>
      </tr>
      <tr>
        <td>특수학급 수업인가요?</td>
        <td>
          <select id="algo-special" onchange="toggleMovementQuestion()">
            <option>예</option>
            <option>아니오</option>
          </select>
        </td>
      </tr>
      <tr id="movement-question" style="display: none;">
        <td>지정 장소로 이동해야하는 과목인가요?</td>
        <td>
          <select id="algo-moving-subject">
            <option>예</option>
            <option>아니오</option>
          </select>
        </td>
      </tr>
      <tr>
        <td><b>예상되는 수업 장소를 선택하세요.</b></td>
        <td>
          <select id="algo-prediction">
            <option>특수학급</option>
            <option>일반학급</option>
            <option>운동장</option>
            <option>음악실</option>
            <option>과학실</option>
            <option>미술실</option>
          </select>
        </td>
      </tr>
    </table>
    <button onclick="checkAlgorithmAnswer()">정답 확인</button>
    <div id="algo-result" style="margin-top:10px;"></div>
  </div>
<script>
const subjects = ["국어", "수학", "사회", "과학", "도덕", "영어", "체육", "미술", "음악", "기술", "가정", "자율", "동아리", "스포츠 클럽", "역사"];
let timetable = {}, special = {};

// 시간표 자동 생성
function generateRandomTimetable() {
  const days = ["월", "화", "수", "목", "금"];
  for (const day of days) {
    timetable[day] = Array.from({length: 7}, () => subjects[Math.floor(Math.random() * subjects.length)]);
    const s = new Set();
    while (s.size < 2) s.add(Math.floor(Math.random() * 7) + 1);
    special[day] = [...s].sort();
  }
}

// 시간표 출력
function renderTimetableTable() {
  const days = ["월", "화", "수", "목", "금"];
  let html = '<table><thead><tr><th>교시</th>' + days.map(d => `<th>${d}</th>`).join('') + '</tr></thead><tbody>';
  for (let i = 0; i < 7; i++) {
    html += `<tr><td>${i + 1}교시</td>` + days.map(day => {
      const cls = special[day].includes(i + 1) ? 'highlight' : '';
      return `<td id="${day}_${i+1}" class="${cls}">${timetable[day][i]}</td>`;
    }).join('') + '</tr>';
  }
  html += '</tbody></table>';
  document.getElementById('timetable-container').innerHTML = html;
}

// 문제 분해 확인
function checkDecomposition() {
  const correct = ["요일", "과목", "교시", "과목별 수업 장소", "특수학급 수업"];
  const selected = Array.from(document.querySelectorAll('.decomp-check:checked')).map(cb => cb.value);
  const result = correct.every(v => selected.includes(v)) && selected.every(v => correct.includes(v));
  document.getElementById('decompResult').innerHTML = result
    ? "<span class='correct'>정답입니다! ✅</span>"
    : "<span class='incorrect'>오답입니다 ❌</span>";
}

// 추상화 출력
function renderAbstraction() {
  const day = document.getElementById('daySelect').value;
  const subs = timetable[day];
  let html = `<h4>${day}요일</h4><table><tr><th>교시</th><th>입력</th></tr>`;
  subs.forEach((_, i) => {
    const bg = special[day].includes(i + 1) ? '#fdd' : '';
    html += `<tr><td>${i + 1}교시</td><td><input id="abs${i+1}" style="background:${bg}" placeholder="과목명"></td></tr>`;
  });
  html += '</table>';
  document.getElementById('abstractionTable').innerHTML = html;
}

// 추상화 정답 확인
function checkAbstraction() {
  const day = document.getElementById('daySelect').value;
  const subs = timetable[day];
  let out = '';
  subs.forEach((ans, i) => {
    const val = document.getElementById(`abs${i+1}`).value.trim();
    out += `${i+1}교시: ` + (val === ans ? '<span class="correct">정답</span>' : '<span class="incorrect">오답</span>') + '<br>';
  });
  document.getElementById('abstractionResult').innerHTML = out;
}

// 패턴 인식 시각화
function checkPatternVisual() {
  clearPatternBorders();
  const selected = Array.from(document.querySelectorAll('.pattern-check:checked')).map(cb => cb.value);

  if (selected.includes("special")) highlightSpecialSubjects();
  if (selected.includes("move")) highlightMovingSubjects();

  const correctAnswers = ["special", "move"];
  const isCorrect = correctAnswers.every(ans => selected.includes(ans)) && selected.length === correctAnswers.length;

  document.getElementById("patternResult").innerHTML = isCorrect
    ? "<span class='correct'>정답입니다! ✅</span>"
    : "<span class='incorrect'>오답입니다 ❌</span>";
}


function clearPatternBorders() {
  document.querySelectorAll("td").forEach(td => {
    td.classList.remove("border-red");
    td.classList.remove("border-blue");
  });
}

function highlightSpecialSubjects() {
  Object.keys(special).forEach(day => {
    special[day].forEach(period => {
      const td = document.getElementById(`${day}_${period}`);
      if (td) td.classList.add("border-red");
    });
  });
}

function highlightMovingSubjects() {
  const moveSubjects = ["체육", "음악", "미술", "과학"];
  Object.keys(timetable).forEach(day => {
    timetable[day].forEach((subj, idx) => {
      const td = document.getElementById(`${day}_${idx+1}`);
      if (td && moveSubjects.includes(subj) && !td.classList.contains("border-red")) {
        td.classList.add("border-blue");
      }
    });
  });
}

// 알고리즘 조건부 질문 표시
function toggleMovementQuestion() {
  const isSpecial = document.getElementById("algo-special").value;
  const row = document.getElementById("movement-question");
  row.style.display = (isSpecial === "아니오") ? "table-row" : "none";
}

function checkAlgorithmAnswer() {
  const subj = document.getElementById("algo-subject").value.trim();
  const isSpecial = document.getElementById("algo-special").value;
  const movingQ = document.getElementById("algo-moving-subject");
  const predicted = document.getElementById("algo-prediction").value;

  let correct = "일반학급";

  if (isSpecial === "예") {
    correct = "특수학급";
  } else {
    if (["체육", "음악", "미술", "과학"].includes(subj)) {
      correct = subj === "체육" ? "운동장" :
                subj === "음악" ? "음악실" :
                subj === "미술" ? "미술실" :
                subj === "과학" ? "과학실" : "일반학급";
    }
  }

  const result = predicted === correct
    ? `<span class="correct">정답입니다! ✅ (${correct})</span>`
    : `<span class="incorrect">오답입니다 ❌<br>정답은 [${correct}]입니다.</span>`;

  document.getElementById("algo-result").innerHTML = result;
}

// 요일·교시 랜덤 출력
function generateRandomDayPeriod() {
  const days = ['월', '화', '수', '목', '금'];
  const periods = ['1교시', '2교시', '3교시', '4교시', '5교시', '6교시', '7교시'];
  const d = days[Math.floor(Math.random() * days.length)];
  const p = periods[Math.floor(Math.random() * periods.length)];
  document.getElementById("randomResult").innerText = `🎲 랜덤 결과: ${d}요일 ${p}`;
}

// 탭 전환
function showTab(idx) {
  document.querySelectorAll(".tab-button").forEach((b, i) => {
    b.classList.toggle("active", i === idx);
    document.querySelectorAll(".tab-content")[i].classList.toggle("active", i === idx);
  });
}

// 초기화
window.onload = () => {
  generateRandomTimetable();
  renderTimetableTable();
  renderAbstraction();
  showTab(0);
};
</script>
</body>
</html>

